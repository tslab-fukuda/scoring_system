{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="{% static 'submission/css/fade.css' %}">
{% endblock %}

{% block content %}
<h2>提出確認</h2>
<p>アップロードしたPDF:</p>
<div id="pdf-container" style="max-height:70vh; overflow-y:auto; background:#fafafa; padding:1em;">
    <!-- JSでページごとにcanvasをappend -->
</div>
<div class="mt-3 text-center">
  <form id="confirmForm" method="post" action="{% url 'submission_complete' submission.id %}">
    {% csrf_token %}
    <button id="confirmBtn" type="submit" class="btn btn-primary mt-4" style="display:none;">提出確定</button>
  </form>
  <a href="{% url 'submit_assignment' %}?date={{ submission.date }}" class="btn btn-outline-danger mt-2">訂正（再提出）</a>
  <a href="{% url 'submit_assignment' %}" class="btn btn-outline-secondary mt-2">さらに提出</a>
  <a href="{% url 'student_dashboard' %}" class="btn btn-outline-success mt-2">ダッシュボードに戻る</a>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script src="{% static 'submission/js/confirm.js' %}"></script>
<script>
  var PDF_URL = "{{ submission.file.url }}";
</script>
{% endblock %}